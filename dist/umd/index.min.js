!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],e):e((t=t||self).UniAppRouter={},t._Vue)}(this,function(t,e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var o={push:"navigateTo",pushTab:"switchTab",replace:"redirectTo",replaceAll:"reLaunch",back:"navigateBack"},r="-";function i(t,e){"undefined"!=typeof console&&console.error("[klk-uni-router] "+e)}var a=!1,u=function(t){return void 0!==t};function c(t){if(!a||e!==t){a=!0;var n={_router:{},_route:{}};t.mixin({beforeCreate:function(){if(u(this.$options.router)){var e=this.$options.router;n._router=e,n._router.init(n),t.util.defineReactive(n,"_route",e.current)}}}),Object.defineProperty(t.prototype,"$router",{get:function(){return n._router}}),Object.defineProperty(t.prototype,"$route",{get:function(){return n._route}})}}function s(t){var e=t.match(/(.+).vue/i),n="";return e?n=e[1]:i(0,"transformPath failed, wrong filePath: "+t),n}var p,f=(p?p("pages/",!0,/\/index.vue$/i):require.context("pages/",!0,/\/index.vue$/i)).keys().map(function(t){return"/pages/"+t.slice(2)}).sort().map(function(t){return{path:s(t),name:(e=t,n=e.match(/\/?pages\/(.+)\/index.vue/i),o="",n?o=n[1].split("/").join(r):i(0,"transformFilePathToName failed, wrong path: "+e),o),children:[]};var e,n,o});function h(t){var e={name:t.name,path:t.path||"/",query:t.query||{}};return Object.freeze(e)}console.log("[router config]","\n[not nested]",f);var l=h({path:"/"});function d(){return f}var v=/^\/?/;function y(t){var e=d().filter(function(e){return n=t,o=e.path,n.replace(v,"")===o.replace(v,"");var n,o});return e&&e[0].name}var m=/[!'()*]/g,g=function(t){return"%"+t.charCodeAt(0).toString(16)},k=/%2C/g,b=function(t){return encodeURIComponent(t).replace(m,g).replace(k,",")},x=decodeURIComponent;function P(t){var e={};return(t=t.trim().replace(/^(\?|#|&)/,""))?(t.split("&").forEach(function(t){var n=t.replace(/\+/g," ").split("="),o=x(n.shift()),r=n.length>0?x(n.join("=")):null;void 0===e[o]?e[o]=r:Array.isArray(e[o])?e[o].push(r):e[o]=[e[o],r]}),e):e}var _=function(t){(function(t){return Object.prototype.toString.call(t).indexOf("Error")>-1})(t)&&(i(0,"uncaught error during route navigation:"),console.error(t))};function j(t,e){return t.push(e),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}var O=function(t){function e(e){var n=t.call(this,e)||this;return n.navigationMethodName="",n}return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}(e,t),e.prototype.pushTab=function(t,e,n){var r=this;if(!e&&!n&&"undefined"!=typeof Promise)return new Promise(function(e,n){r.pushTab(t,e,n)});this.transitionTo(t,function(t){uni[o.pushTab]({url:""+t.pathname+t.search,success:t.onCompleteProxy(function(){r.navigationMethodName="pushTab",r.stack=[t.route],r.index=0,e&&e()}),fail:n})})},e.prototype.push=function(t,e,n){var r=this;if(!e&&!n&&"undefined"!=typeof Promise)return new Promise(function(e,n){r.push(t,e,n)});this.transitionTo(t,function(t){uni[o.push]({url:""+t.pathname+t.search,success:t.onCompleteProxy(function(){r.navigationMethodName="push",r.pushStack(t.route),e&&e()}),fail:n})})},e.prototype.replace=function(t,e,n){var r=this;if(!e&&!n&&"undefined"!=typeof Promise)return new Promise(function(e,n){r.replace(t,e,n)});this.transitionTo(t,function(t){uni[o.replace]({url:""+t.pathname+t.search,success:t.onCompleteProxy(function(){r.navigationMethodName="replace",r.stack=r.stack.slice(0,r.index).concat(t.route),e&&e()}),fail:n})})},e.prototype.replaceAll=function(t,e,n){var r=this;if(!e&&!n&&"undefined"!=typeof Promise)return new Promise(function(e,n){r.replaceAll(t,e,n)});this.transitionTo(t,function(t){uni[o.replaceAll]({url:""+t.pathname+t.search,success:t.onCompleteProxy(function(){r.navigationMethodName="replaceAll",r.stack=[t.route],r.index=0,e&&e()}),fail:n})})},e.prototype.back=function(t){void 0===t&&(t=1),this.go(-t)},e.prototype.go=function(t){var e=this;void 0===t&&(t=0);uni[o.back]({delta:-t});var n=this.index+t;if(!(n<0||n>=this.stack.length)){var r=this.stack[n];return this.transitionTo(r,function(t){t.onCompleteProxy(function(){e.navigationMethodName="back",e.stack=e.stack.slice(0,n+1),e.index=n})})}i(0,"[back go history error]: target index: "+n+", current index: "+this.index+", history stack info: "+this.stack+" ")},e}(function(){function t(t){this.maxStackSize=50,this.cb=function(t){},this.options=t,this.stack=[],this.index=-1,this.beforeHooks=[],this.afterHooks=[],this.current=l}return t.prototype.go=function(t){},t.prototype.push=function(t,e,n){},t.prototype.replace=function(t,e,n){},t.prototype.resolveBeforeHooks=function(t,e){var n,o,r,i;n=this.beforeHooks,o=t,r=function(){e()},(i=function(t){t>=n.length?r():n[t]?o(n[t],function(){i(t+1)}):i(t+1)})(0)},t.prototype.resolve=function(t){var e,n;"string"==typeof t?t={path:t}:!t.path&&t.name?t.path=(e=t.name,(n=d().filter(function(t){return e===t.name}))&&n[0].path):t.path&&!t.name&&(t.name=y(t.path)),t.path||t.name||i(0,"Must provide location path or name!");var o,r,a=function(t){void 0===t&&(t="");var e="",n="",o=t.indexOf("#");o>=0&&(e=t.slice(o),t=t.slice(0,o));var r=t.indexOf("?");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{path:t,query:n,hash:e}}(t.path),u=function(t,e,n){void 0===e&&(e={});var o,r=n||P;try{o=r(t||"")}catch(t){i(0,t.message),o={}}for(var a in e){var u=e[a];o[a]=Array.isArray(u)?u.slice():u}return o}(a.query,t.query),c=(r=(o=u)?Object.keys(o).map(function(t){var e=o[t];if(void 0===e)return"";if(null===e)return b(t);if(Array.isArray(e)){var n=[];return e.forEach(function(e){void 0!==e&&(null===e?n.push(b(t)):n.push(b(t)+"="+b(e)))}),n.join("&")}return b(t)+"="+b(e)}).filter(function(t){return t.length>0}).join("&"):null)?"?"+r:"";return{name:t.name,path:a.path,hash:a.hash,pathname:a.path,search:c,query:u}},t.prototype.transitionTo=function(t,e){var n=this,o=this.resolve(t),r=h(o),i=this.current;this.resolveBeforeHooks(function(t,e){try{t(r,i,function(t){"string"==typeof t||"object"==typeof t&&("string"==typeof t.path||"string"==typeof t.name)?(_(),"object"==typeof t&&t.replace?n.replace(t):n.push(t)):e(t)})}catch(t){_(t)}},function(){e?e({route:r,pathname:o.pathname,search:o.search,onCompleteProxy:function(t){t&&t(),n.updateRoute(r)}}):(n.updateRoute(r),n.pushStack(r))})},t.prototype.pushStack=function(t){this.stack=this.stack.slice(0,this.index+1).concat(t).slice(-this.maxStackSize),this.index++},t.prototype.updateRoute=function(t){var e=this.current;this.current=t,this.cb&&this.cb(t),this.afterHooks.forEach(function(n){n&&n(t,e)})},t.prototype.beforeEach=function(t){return j(this.beforeHooks,t)},t.prototype.afterEach=function(t){return j(this.afterHooks,t)},t.prototype.listen=function(t){this.cb=t},t.prototype.init=function(t){this.listen(function(e){t._route=e})},t.install=c,t}());t.UniRouter=O,t.default=O,Object.defineProperty(t,"__esModule",{value:!0})});
